{% extends "base.html" %}
{% block content %}
<div class="container mx-auto p-4 max-w-4xl">
    <h1 class="text-3xl font-bold mb-8 text-center text-purple-700">ğŸ”® ë‚´ ë¡œë˜ ë²ˆí˜¸ ë¶„ì„</h1>

    <div class="bg-white p-6 rounded-xl shadow-2xl border border-gray-100 mb-8">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">ë²ˆí˜¸ ì…ë ¥ ë° ë¶„ì„</h2>
        <form action="{{ url_for('check_pick_analysis_route') }}" method="POST">
            <div class="flex flex-wrap justify-center gap-4 mb-6">
                {% for i in range(1, 7) %}
                <div class="w-16">
                    <label for="number_{{ i }}" class="block text-sm font-medium text-gray-700 text-center mb-1">ë²ˆí˜¸ {{ i }}</label>
                    <input type="number" id="number_{{ i }}" name="number_{{ i }}" min="1" max="45" required
                           class="w-full text-center p-3 border-2 border-purple-300 rounded-lg focus:ring-purple-500 focus:border-purple-500 text-lg font-bold shadow-sm"
                           value="{{ input_numbers[loop.index0] if input_numbers }}">
                </div>
                {% endfor %}
            </div>
            
            <button type="submit"
                    class="w-full bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 transition duration-150 ease-in-out font-bold shadow-md hover:shadow-lg">
                âœ… ë¡œë˜ ë²ˆí˜¸ ë¶„ì„ ì‹œì‘
            </button>
        </form>
    </div>

    <!-- ë¶„ì„ ê²°ê³¼ í‘œì‹œ ë¶€ë¶„ -->
    {% if comments or detailed_stats %}
    <div class="analysis-results bg-white p-6 rounded-xl shadow-2xl border border-gray-100 mb-8">
        
        <!-- 1. ì¢…í•© ë¶„ì„ ì½”ë©˜íŠ¸ -->
        {% if comments %}
        <h2 class="text-2xl font-bold mb-4 text-gray-700 border-b pb-2">âœ¨ ì¢…í•© ë¶„ì„ ì½”ë©˜íŠ¸</h2>
        <ul class="list-none space-y-3 mb-6 p-0">
            {% for comment in comments %}
            <li class="flex items-start text-gray-700">
                <!-- ì•„ì´ì½˜ìœ¼ë¡œ ì¤‘ìš”ë„ í‘œì‹œ -->
                <span class="mr-2 text-lg">
                {% if 'ğŸš¨' in comment %}
                    <span class="text-red-500">âŒ</span>
                {% elif 'â­' in comment %}
                    <span class="text-green-500">â­</span>
                {% else %}
                    <span class="text-blue-500">ğŸ’¡</span>
                {% endif %}
                </span>
                {{ comment | safe }}
            </li>
            {% endfor %}
        </ul>
        {% endif %}

        <!-- 2. ìƒì„¸ í†µê³„ í…Œì´ë¸” -->
        {% if detailed_stats %}
        <div class="mt-8">
            <h2 class="text-2xl font-bold mb-4 text-gray-700 border-b pb-2">ğŸ“Š ìƒì„¸ í†µê³„ ë¶„ì„ ê²°ê³¼ (ê°œë³„ ë²ˆí˜¸)</h2>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200 rounded-lg overflow-hidden shadow-lg">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="py-3 px-6 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">ë²ˆí˜¸</th>
                            <th class="py-3 px-6 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">ì¶”ì²œ ì ìˆ˜ <span class="text-purple-500">(Total Score)</span></th>
                            <th class="py-3 px-6 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">ì´ ì¶œí˜„ íšŸìˆ˜ <span class="text-blue-500">(Frequency)</span></th>
                            <th class="py-3 px-6 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">ìµœê·¼ ë¯¸ì¶œí˜„ ê°„ê²© <span class="text-red-500">(Draw Gap)</span></th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        {% for stat in detailed_stats %}
                        <tr class="hover:bg-gray-50">
                            <td class="py-3 px-6 text-center font-bold text-purple-600">{{ stat.number }}</td>
                            <td class="py-3 px-6 text-center font-bold text-green-600">{{ stat.total_score | float | round(2) }}</td>
                            <td class="py-3 px-6 text-center">{{ stat.frequency }}</td>
                            <td class="py-3 px-6 text-center">{{ stat.last_draw_gap }}íšŒì°¨</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}
    </div>
    {% endif %}

    <div class="mt-10 text-center text-gray-500 text-sm">
        <p>ğŸ’¡ ë¶„ì„ ê²°ê³¼ëŠ” ê³¼ê±° ë‹¹ì²¨ í†µê³„ì— ê¸°ë°˜í•œ ì°¸ê³  ìë£Œì¼ ë¿ì…ë‹ˆë‹¤. ë¡œë˜ëŠ” í–‰ìš´ì´ ì¤‘ìš”í•©ë‹ˆë‹¤!</p>
    </div>
    
</div>
{% endblock %}